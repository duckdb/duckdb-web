---
warning: DO NOT CHANGE THIS MANUALLY, THIS IS GENERATED BY https://github/duckdb/community-extensions repository, check README there
title: sitemap
excerpt: |
  DuckDB Community Extensions
  Parse XML sitemaps from websites with automatic discovery via robots.txt

extension:
  name: sitemap
  description: Parse XML sitemaps from websites with automatic discovery via robots.txt
  version: '2026020501'
  language: C++
  build: cmake
  license: MIT
  excluded_platforms: "windows_amd64_mingw"
  requires_toolchains: "libxml2;zlib"
  maintainers:
    - onnimonni

repo:
  github: midwork-finds-jobs/duckdb-sitemap
  ref: 4c873c85c3f7c8dcab6154de51aa218f61677634
  ref_next: 15e96dfd6e5dfb6d70a9b7cc5a2675b3969e16b3

docs:
  hello_world: |
    -- Get all URLs from a sitemap (auto-prepends https://)
    SELECT * FROM sitemap_urls('example.com');

    -- Direct sitemap URL (skips discovery)
    SELECT * FROM sitemap_urls('https://example.com/sitemap.xml');

    -- Get URLs from multiple sites
    SELECT * FROM sitemap_urls(['example.com', 'google.com']);

    -- Filter specific URLs
    SELECT * FROM sitemap_urls('example.com')
    WHERE url LIKE '%/blog/%';

    -- Bruteforce find sitemap (tries 587+ patterns)
    SELECT bruteforce_find_sitemap('example.com') as sitemap_url;

    -- Ignore errors for invalid domains
    SELECT * FROM sitemap_urls(['valid.com', 'invalid.com'], ignore_errors := true);

    -- Set custom user agent
    SET sitemap_user_agent = 'MyBot/1.0';

    -- Count URLs by type
    SELECT
        CASE
            WHEN url LIKE '%/product/%' THEN 'product'
            WHEN url LIKE '%/blog/%' THEN 'blog'
            ELSE 'other'
        END as type,
        count(*) as count
    FROM sitemap_urls('https://example.com')
    GROUP BY type;

  extended_description: |
    The sitemap extension provides a table function for parsing XML sitemaps from websites.
    It automatically discovers sitemaps via multiple fallback methods and supports recursive sitemap index traversal.

    Features:
    - Multi-fallback sitemap discovery (robots.txt, /sitemap.xml, /sitemap_index.xml, HTML meta tags)
    - Session caching for discovered sitemap locations
    - Bruteforce finder (bruteforce_find_sitemap) - tries 587+ common sitemap URL patterns
    - Custom user agent via SET sitemap_user_agent
    - Direct sitemap URL support (skips discovery)
    - Sitemap index support (nested sitemaps)
    - Array support for processing multiple domains
    - Retry logic with exponential backoff
    - Respects Retry-After header on 429 responses
    - Gzip decompression for .xml.gz files
    - Multiple namespace support (standard + Google schemas)
    - SQL filtering with WHERE clauses
    - Optional error ignoring for batch processing

    The function returns a table with columns:
    - url: Page URL (VARCHAR)
    - lastmod: Last modification date (VARCHAR, optional)
    - changefreq: Change frequency hint (VARCHAR, optional)
    - priority: Priority hint 0.0-1.0 (VARCHAR, optional)

    Options:
    - follow_robots (BOOLEAN): Parse robots.txt first (default: true)
    - max_depth (INTEGER): Max sitemap index nesting (default: 3)
    - max_retries (INTEGER): Max retry attempts (default: 5)
    - backoff_ms (INTEGER): Initial backoff in ms (default: 100)
    - max_backoff_ms (INTEGER): Max backoff cap in ms (default: 30000)
    - ignore_errors (BOOLEAN): Don't throw on failed fetches (default: false)

    Example with options:
    ```sql
    SELECT * FROM sitemap_urls(
        'https://example.com',
        follow_robots := true,
        max_depth := 5,
        max_retries := 10
    ) WHERE url LIKE '%/product/%';
    ```

    Bruteforce sitemap discovery (scalar function):
    ```sql
    -- Find sitemap by trying 587+ common patterns
    SELECT bruteforce_find_sitemap('https://example.com') as sitemap_url;
    -- Returns first working sitemap URL or NULL

    -- Patterns tested include:
    -- /sitemap.xml, /sitemap_index.xml
    -- /sitemap/sitemap.xml, /sitemaps/sitemap-index.xml
    -- /en/sitemap.xml, /de/sitemap.xml
    -- /pub/media/sitemap.xml
    -- And 580+ more variations
    ```

    Compose with http_request to fetch page content:
    ```sql
    SELECT s.url, h.body
    FROM sitemap_urls('https://example.com') s
    JOIN LATERAL (SELECT * FROM http_get(s.url)) h ON true
    WHERE s.url LIKE '%/product/%'
    LIMIT 10;
    ```

extension_star_count: 1
extension_star_count_pretty: 1
extension_download_count: 442
extension_download_count_pretty: 442
image: '/images/community_extensions/social_preview/preview_community_extension_sitemap.png'
layout: community_extension_doc
---

### Installing and Loading
```sql
INSTALL {{ page.extension.name }} FROM community;
LOAD {{ page.extension.name }};
```

{% if page.docs.hello_world %}
### Example
```sql
{{ page.docs.hello_world }}```
{% endif %}

{% if page.docs.extended_description %}
### About {{ page.extension.name }}
{{ page.docs.extended_description }}
{% endif %}


