/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/regular-table@0.6.8/dist/esm/regular-table.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var T=new WeakMap,st=!0,pt=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,_t=pt?5e6:1e7,j=0,O=0,nt=performance.now();function rt(){let t=performance.now(),e=t-nt,i=j,s=1e3*O/e,l=O;return j=0,O=0,nt=t,{avg:i,real_fps:s,virtual_fps:1e3/i,num_frames:l,elapsed:e}}function ht(t){j=(j*O+t)/(O+1),O+=1}var q=(t,...e)=>t.map(((t,i)=>[t,e[i]])).flat().filter((t=>!!t)).join(""),wt=()=>{let t,e=new Promise((e=>{t=e}));return e.resolve=t,e},C=new Map;async function ct(t){return await new Promise(requestAnimationFrame),await C.get(t)}async function U(t,e){if(C.has(t)&&(await C.get(t),C.has(t)))await C.get(t);else{C.set(t,wt());try{return await e()}finally{let e=C.get(t);C.delete(t),e.resolve()}}}var dt=":host{position:absolute;top:0px;left:0px;right:0px;bottom:0px;overflow:scroll;overflow-anchor:none;overscroll-behavior:none;-webkit-overflow-scrolling:touch;}div.rt-virtual-panel{position:absolute;top:0;left:0;right:0;pointer-events:none;}div.rt-scroll-table-clip{position:sticky;contain:strict;overflow-anchor:none;width:100%;height:100%;}div.rt-tree-container{display:flex;align-items:center;height:100%;}slot{position:absolute;overflow:hidden;overflow-anchor:none;}",ut=":host ::slotted(table){--regular-table--transform-x:0px;--regular-table--transform-y:0px;--regular-table--clip-x:0px;--regular-table--clip-y:0px;}",K=class extends HTMLElement{create_shadow_dom(){this.attachShadow({mode:"open"});this.shadowRoot.innerHTML=q`
            <style>
                ${dt}
            </style>
            <style>
                ${ut}
            </style>
            <div class="rt-virtual-panel"></div>
            <div class="rt-scroll-table-clip">${"<slot></slot>"}</div>
        `;let[,t,e,i]=this.shadowRoot.children;this._sub_cell_style=t,this._table_clip=i,this._virtual_panel=e,this._setup_virtual_scroll()}_setup_virtual_scroll(){this._table_clip&&("both"===this._virtual_mode||"vertical"===this._virtual_mode?this._table_clip.style.top="0px":this._table_clip.style.removeProperty("top"),"both"===this._virtual_mode||"horizontal"===this._virtual_mode?this._table_clip.style.left="0px":this._table_clip.style.removeProperty("left"),"both"!==this._virtual_mode?this._table_clip.style.contain="none":this._table_clip.style.removeProperty("contain"))}_calculate_viewport(t,e){let{start_row:i,end_row:s}=this._calculate_row_range(t),{start_col:l,end_col:a}=this._calculate_column_range(e);return this._nrows=t,{start_col:l,end_col:a,start_row:i,end_row:s}}_calculate_row_range(t){let{height:e}=this._container_size,i=this._column_sizes.row_height||19,s=this._view_cache.config.column_pivots.length,l=Math.max(1,this._virtual_panel.offsetHeight-e),a=Math.max(Math.ceil(this.scrollTop),0)/l,_=e/i-s,o=Math.max(0,(t||0)-_)*a;return{start_row:o,end_row:Math.max(0,Math.min(o+_,t))}}_calc_start_column(){let t=this._view_cache.config.row_pivots.length,e=0,i=0,s=0;for(;i<this.scrollLeft;){let l=this._column_sizes.indices[e+t];s=this.scrollLeft-i,e+=1,i+=void 0!==l?l:60}return e+=s/(this._column_sizes.indices[e+t-1]||60),Math.max(0,e-1)}_calculate_column_range(t){if("none"===this._virtual_mode||"vertical"===this._virtual_mode)return{start_col:0,end_col:1/0};{let e=this._calc_start_column();return{start_col:e,end_col:e+(this.table_model.num_columns()||Math.min(t,Math.ceil(this._container_size.width/60)))+1}}}_max_scroll_column(t){let e=0;if(this._view_cache.config.row_pivots.length>0)for(let t of this._column_sizes.indices.slice(0,this._view_cache.config.row_pivots.length))e+=t;let i=this._view_cache.config.row_pivots.length,s=t;for(;e<this._container_size.width&&s>=0;)s--,e+=this._column_sizes.indices[s+i]||60;return Math.min(t-1,s+1)}_validate_viewport({start_col:t,end_col:e,start_row:i,end_row:s}){i=Math.floor(i),s=Math.ceil(s),t=Math.floor(t),e=Math.ceil(e);let l=this._start_col!==t,a=this._start_row!==i||this._end_row!==s||this._end_col!==e;return this._start_col=t,this._end_col=e,this._start_row=i,this._end_row=s,{invalid_column:l,invalid_row:a}}_calc_scrollable_column_width(t){let e=this._view_cache.config.row_pivots.length,i=this._max_scroll_column(t),s=e,l=0;for(;s<i+e;)l+=this._column_sizes.indices[s]||60,s++;if(s<this._column_sizes.indices.length){let t=this._column_sizes.indices.slice(0,this._view_cache.config.row_pivots.length).reduce(((t,e)=>t+e),0);l+=Math.max(0,this._column_sizes.indices[s]-(this._container_size.width-t)||0)}return l}_update_virtual_panel_width(t,e){if(t)if("vertical"===this._virtual_mode||"none"===this._virtual_mode)this._virtual_panel.style.width=this._column_sizes.indices.reduce(((t,e)=>t+e),0)+"px";else{let t=this._calc_scrollable_column_width(e);if(0!==t){let e=this._container_size.width+t+2;this._virtual_panel.style.width=e+"px"}else this._virtual_panel.style.width="1px"}}_update_virtual_panel_height(t){let e,{row_height:i=19}=this._column_sizes,s=this._view_cache.config.column_pivots.length*i;e=Math.min(_t,t*i+s),this._virtual_panel.style.height=`${e}px`}async draw(t={}){return typeof t.throttle<"u"&&!t.throttle?await ft.call(this,t):await U(this,(()=>ft.call(this,t)))}async _draw_flush(){await ct(this)}update_sub_cell_offset(t){let e=this._column_sizes.row_height*(t.start_row%1)||0,i=this._column_sizes.indices[(this.table_model._row_headers_length||0)+Math.floor(t.start_col)]*(t.start_col%1)||0,s=this._sub_cell_style.sheet?.cssRules[0].style;s&&(s.setProperty("--regular-table--clip-x",`${i}px`),s.setProperty("--regular-table--clip-y",`${e}px`),s.setProperty("--regular-table--transform-x",`-${i}px`),s.setProperty("--regular-table--transform-y",`-${e}px`))}};async function ft(t){let e=st&&performance.now(),{invalid_viewport:i=!0,preserve_width:s=!1}=t,{num_columns:l,num_rows:a,num_row_headers:_,num_column_headers:o,row_height:r}=await this._view_cache.view(0,0,0,0);void 0!==_&&(this._view_cache.row_pivots=Array(_).fill(0)),void 0!==o&&(this._view_cache.column_pivots=Array(o).fill(0)),this._container_size={width:"none"===this._virtual_mode||"vertical"===this._virtual_mode?1/0:this._table_clip.clientWidth,height:"none"===this._virtual_mode||"horizontal"===this._virtual_mode?1/0:this._table_clip.clientHeight},this._update_virtual_panel_height(a),s||this._update_virtual_panel_width(i,l);let h=this._calculate_viewport(a,l),{invalid_row:n,invalid_column:c}=this._validate_viewport(h);if(this._invalid_schema||n||c||i){let t=[],e=!0;for await(let i of this.table_model.draw(this._container_size,this._view_cache,this._selected_id,s,h,l)){void 0!==i&&(t=t.concat(i)),e&&(this.update_sub_cell_offset(h),e=!1),this._is_styling=!0;let s=this._style_callbacks;for(let t of s)await t({detail:this});if(this._is_styling=!1,!this._invalidated&&void 0!==i)break;this._invalidated=!1}this.table_model.autosize_cells(t,r),this.table_model.header.reset_header_cache(),s||this._update_virtual_panel_width(this._invalid_schema||c,l),this._invalid_schema=!1}else this.update_sub_cell_offset(h);st&&ht(performance.now()-e)}var yt=!1,J=class extends K{register_listeners(){this.addEventListener("mousedown",this._on_click_or_dblclick.bind(this)),this.addEventListener("scroll",this._on_scroll.bind(this),{passive:!0}),this._register_glitch_scroll_listeners()}async _on_scroll(t){t.stopPropagation(),await this.draw({invalid_viewport:!1}),this.dispatchEvent(new CustomEvent("regular-table-scroll"))}_register_glitch_scroll_listeners(){this.addEventListener("mousewheel",this._on_mousewheel.bind(this),{passive:!0}),yt&&(this.addEventListener("touchmove",this._on_touchmove.bind(this)),this.addEventListener("touchstart",this._on_touchstart.bind(this),{passive:!0}))}_on_mousewheel(t){if(!window.safari)return;let{clientWidth:e,clientHeight:i,scrollTop:s,scrollLeft:l}=this;t.preventDefault(),t.returnValue=!1;let a=Math.max(1,this._virtual_panel.offsetHeight-i),_=Math.max(1,this._virtual_panel.offsetWidth-e);this.scrollTop=Math.max(0,Math.min(a,s+t.deltaY)),this.scrollLeft=Math.max(0,Math.min(_,l+t.deltaX)),this._on_scroll(t)}_on_touchmove(t){t.stopPropagation(),t.preventDefault(),t.returnValue=!1;let{clientWidth:e,clientHeight:i}=this,s=Math.max(1,this._virtual_panel.offsetHeight-i),l=Math.max(1,this._virtual_panel.offsetWidth-e);this.scrollTop=Math.min(s,this._memo_scroll_top+(this._memo_touch_startY-t.touches[0].pageY)),this.scrollLeft=Math.min(l,this._memo_scroll_left+(this._memo_touch_startX-t.touches[0].pageX)),this._on_scroll(t)}_on_touchstart(t){this._memo_touch_startY=t.touches[0].pageY,this._memo_touch_startX=t.touches[0].pageX,this._memo_scroll_top=this.scrollTop,this._memo_scroll_left=this.scrollLeft}async _on_dblclick(t){let e=t.target;for(;"TD"!==e.tagName&&"TH"!==e.tagName;)if(e=e.parentElement,!this.contains(e))return;let i=t.target.classList.contains("rt-column-resize"),s=T.get(e);if(i){t.stopImmediatePropagation(),e.style.minWidth="",e.style.maxWidth="",t.shiftKey?(this._column_sizes.override=[],this._column_sizes.auto=[],this._column_sizes.indices=[]):(this._column_sizes.override[s.size_key]=void 0,this._column_sizes.auto[s.size_key]=void 0,this._column_sizes.indices[s.size_key]=void 0);for(let e of t.shiftKey?[this.table_model.header.cells[this.table_model.header.cells.length-1],...this.table_model.body.cells]:this.table_model.body.cells)for(let i of t.shiftKey?e:[e[s._virtual_x]])i&&(i.style.minWidth="",i.style.maxWidth="",i.classList.remove("rt-cell-clip"));await this.draw()}}async _on_click(t){if(0!==t.button)return;let e=t.target;for(;"TD"!==e.tagName&&"TH"!==e.tagName;)if(e=e.parentElement,!this.contains(e))return;let i=t.target.classList.contains("rt-column-resize"),s=T.get(e);i&&(this._on_resize_column(t,e,s),t.stopImmediatePropagation())}async _on_click_or_dblclick(t){let e=performance.now();this._last_clicked_time&&e-this._last_clicked_time<500?(this._last_clicked_time=e,await this._on_dblclick(t)):(this._last_clicked_time=e,await this._on_click(t))}_on_resize_column(t,e,i){let{_virtual_x:s,size_key:l}=i,a=t.pageX,_=s+e.colSpan-1,o=this.table_model.header.get_column_header(_),r=this._column_sizes.indices[l],h=t=>U(this,(async()=>await this._on_resize_column_move(t,o,a,r,l,_))),n=()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",n);let t=this._column_sizes.override[l],e=this._column_sizes.indices[l]!==t;this._column_sizes.indices[l]=t,e&&this.draw()};document.addEventListener("mousemove",h),document.addEventListener("mouseup",n)}async _on_resize_column_move(t,e,i,s,l,a){await new Promise(requestAnimationFrame);let _=t.pageX-i,o=Math.max(1,s+_);if(this._column_sizes.override[l]=o,_<0)await this.draw({preserve_width:!0,throttle:!1});else{e.style.minWidth=o+"px",e.style.maxWidth=o+"px";let t=this._column_sizes.auto[l];for(let e of this.table_model.body.cells){let i=e[a];i&&(i.style.maxWidth=i.style.minWidth=o+"px",i.classList.toggle("rt-cell-clip",t>o))}}}},ot=class{constructor(t){this._name=t,this._elements=[],this._index=0}reset(){this._index=0}get(){this._elements[this._index]||(this._elements[this._index]=document.createElement(this._name));let t=this._elements[this._index];return this._index+=1,t}},$=class{constructor(t,e,i){this._column_sizes=t,this._container=e,this._span_factory=new ot("span"),this.table=i,this.cells=[],this.rows=[]}num_columns(){return this._get_row(Math.max(0,this.rows.length-1)).row_container.length}num_rows(){return this.cells.length}_set_metadata(t,e){T.set(t,e)}_get_or_create_metadata(t){if(void 0===t)return{};if(T.has(t))return T.get(t);{let e={};return T.set(t,e),e}}_replace_cell(t,e){let{tr:i,row_container:s}=this._get_row(t),l=s[e];return l&&(i.removeChild(l),s.splice(e,1,void 0)),l}_fetch_cell(t,e){if(!(t<0||e<0))return this.cells[t]?.[e]}_get_row(t){let e=this.rows[t];e||(e=this.rows[t]=document.createElement("tr"),this.table.appendChild(e));let i=this.cells[t];return i||(i=this.cells[t]=[]),{tr:e,row_container:i}}_get_cell(t="TD",e,i){let{tr:s,row_container:l}=this._get_row(e),a=l[i];if(a||(i<l.length?(a=l[i]=document.createElement(t),s.insertBefore(a,l.slice(i+1).find((t=>t)))):(a=l[i]=document.createElement(t),s.appendChild(a))),a.tagName!==t){let l=document.createElement(t);s.replaceChild(l,a),this.cells[e].splice(i,1,l),a=l}return a}_clean_columns(t){for(let e=0;e<this.rows.length;e++){let i=this.rows[e],s=this.cells[e];this.cells[e]=s.slice(0,t[e]||t);let l=this.cells[e].filter((t=>void 0!==t)).length;for(;i.children[l];)i.removeChild(i.children[l])}}_clean_rows(t){for(;this.table.children[t];)this.table.removeChild(this.table.children[t]);this.rows=this.rows.slice(0,t),this.cells=this.cells.slice(0,t)}},Q=class extends ${constructor(...t){super(...t),this._group_header_cache=[],this._offset_cache=[]}_draw_group_th(t,e,i){let s=this._get_cell("TH",e,t[e]||0);if(t[e]+=1,s.removeAttribute("colspan"),s.style.minWidth="0",s.textContent="",i instanceof HTMLElement)s.appendChild(i);else{let t=this._span_factory.get("span");t.textContent=i,s.appendChild(t)}let l=this._span_factory.get("span");return l.className="rt-column-resize",s.appendChild(l),s}_draw_group(t,e,i){let s=this._get_or_create_metadata(i);return s.column_header=t,s.value=e,s.value=e,s}_draw_th(t,e,i,s,l){let a=this._get_or_create_metadata(i);if(a.column_header=t,a.value=e,a.size_key=l.length?l[0]:l,!(l.length>1)){let t=this._column_sizes.override[a.size_key],e=this._column_sizes.auto[a.size_key];t?(i.classList.toggle("rt-cell-clip",e>t),i.style.minWidth=t+"px",i.style.maxWidth=t+"px"):e?(i.classList.remove("rt-cell-clip"),i.style.maxWidth="",i.style.minWidth=e+"px"):(i.style.maxWidth="",i.style.maxWidth="")}return a}get_column_header(t){return this._get_cell("TH",this.num_rows()-1,t)}draw(t,e,i,s,l,a,_,o,r){let h,n,c,d,m=e?.length;if(0!==m){o=typeof o>"u"?m-1:o;for(let u=0;u<m;u++){if(c=e[u]?e[u]:"",this._offset_cache[u]=this._offset_cache[u]||0,u<o)r&&this._group_header_cache?.[u]?.[0]?.value===c?(h=this._group_header_cache[u][1],this._group_header_cache[u][2]+=1,1===i&&(this._group_header_cache[u][0].row_header_x=l),h.setAttribute("colspan",this._group_header_cache[u][2])):(h=this._draw_group_th(this._offset_cache,u,c),n=this._draw_group(e,c,h),this._group_header_cache[u]=[n,h,1]);else{h=this._draw_group_th(this._offset_cache,u,c),n=this._draw_th(t||e,c,h,s,l),typeof d>"u"&&(d={th:h,metadata:n});for(let[t]of this._group_header_cache)t.size_key=n.size_key;h.removeAttribute("colspan")}this._get_row(u).tr.classList.toggle("rt-autosize",u===o),h.classList.toggle("rt-group-corner",void 0===s),n&&(n.x=typeof s>"u"?s:Math.floor(s),n.column_header_y=u,n.x0=Math.floor(a),n._virtual_x=_,1===i&&(n.row_header_x=l))}return this._clean_rows(this._offset_cache.length),d=d||{th:h,metadata:n},d}}clean(){this._clean_columns(this._offset_cache)}reset_header_cache(){this._offset_cache=[],this._group_header_cache=[]}},Z=class extends ${_draw_td(t,e,i,s,{column_name:l},{ridx_offset:a},_){let o=this._get_cell(t,e,s),r=this._get_or_create_metadata(o);r.y=e+Math.floor(a),r.size_key=_,"TD"===t&&(r.column_header=l);let h=this._column_sizes.override[r.size_key];if(h){let t=this._column_sizes.auto[r.size_key];o.classList.toggle("rt-cell-clip",t>h),o.style.minWidth=h+"px",o.style.maxWidth=h+"px"}else o.classList.remove("rt-cell-clip"),o.style.minWidth="",o.style.maxWidth="";return r.value!==i&&(i instanceof HTMLElement?(o.textContent="",o.appendChild(i)):o.textContent=i),r.value=i,{td:o,metadata:r}}draw(t,e,i,s=!1,l,a,_,o){let r,{cidx:h,column_data:n,row_headers:c,column_data_listener_metadata:d}=e,{row_height:m}=i,u=[],f=[],w=0,p=[];for(let v=0;v<(s?i.row_headers_length:1);v++){w=0;for(let g of n){let n,y=c?.[w];if(s){let t=g[v],s=this._fetch_cell(w-(u[v]||1),h+v),l=this._get_or_create_metadata(s),_=this._fetch_cell(w,h+v-(p[w]||1)),r=this._get_or_create_metadata(_);!o||!_||r.value!==t&&void 0!==t||_.hasAttribute("rowspan")?o&&s&&l.value===t&&!s.hasAttribute("colspan")?(u[v]=u[v]?u[v]+1:2,s.setAttribute("rowspan",u[v]),this._replace_cell(w,h+v)):(n=this._draw_td("TH",w,t,h+v,e,i,v),n.td.style.display="",n.td.removeAttribute("rowspan"),n.td.removeAttribute("colspan"),n.metadata.row_header=g,n.metadata.row_header_x=v,n.metadata.y0=Math.floor(i.ridx_offset),n.metadata.y1=Math.ceil(i.y1),n.metadata._virtual_x=v,typeof a<"u"&&(n.metadata.x0=Math.floor(a)),u[v]=1,p[w]=1,f[v]=n):(p[w]=p[w]?p[w]+1:2,_.setAttribute("colspan",p[w]),this._replace_cell(w,h+v))}else n=this._draw_td("TD",w,g,h,e,i,_),d&&(n.metadata.user=d[w]),n.metadata.x=typeof l>"u"?l:Math.floor(l),n.metadata.x1=Math.ceil(i.x1),n.metadata.row_header=y||[],n.metadata.y0=Math.floor(i.ridx_offset),n.metadata.y1=Math.ceil(i.y1),n.metadata.dx=Math.floor(l-a),n.metadata.dy=n.metadata.y-Math.floor(n.metadata.y0),n.metadata._virtual_x=h,typeof a<"u"&&(n.metadata.x0=Math.floor(a)),f[0]=n;if(w++,r=n?n.metadata:r,m=m||n?.td.offsetHeight,w*m>t)break}}return this._clean_rows(w),{tds:f,ridx:w,metadata:r,row_height:m}}clean({ridx:t,cidx:e}){this._clean_rows(t),this._clean_columns(e)}},V=class{constructor(t,e,i){this.clear(i);let[s]=i.children,[l,a]=s.children;this.table=s,this._column_sizes=e,this.header=new Q(e,t,l),this.body=new Z(e,t,a),this.fragment=document.createDocumentFragment()}num_columns(){return this.header.num_columns()}clear(t){t.innerHTML=q`
            <table cellspacing="0">
                <thead></thead>
                <tbody></tbody>
            </table>
        `}autosize_cells(t,e){for(;t.length>0;){let[i,s]=t.pop(),l=i.getBoundingClientRect();if(!l||(this._column_sizes.row_height=e||Math.max(10,Math.min(this._column_sizes.row_height||l.height,l.height)),!s))continue;this._column_sizes.indices[s.size_key]=l.width;let a=void 0!==this._column_sizes.override[s.size_key];l.width&&!a&&(this._column_sizes.auto[s.size_key]=l.width),"0px"===i.style.minWidth&&(i.style.minWidth=`${l.width}px`)}}async*draw(t,e,i,s,l,a){let{width:_,height:o}=t,{view:r,config:h}=e,{data:n,row_headers:c,column_headers:d,metadata:m,num_row_headers:u,num_column_headers:f,column_header_merge_depth:w,merge_headers:p="both"}=await r(Math.floor(l.start_col),Math.floor(l.start_row),Math.ceil(l.end_col),Math.ceil(l.end_row)),v="both"===p||"row"===p,g="both"===p||"column"===p,{start_row:y=0,start_col:b=0,end_col:x=0,end_row:z=0}=l;c&&(this._row_headers_length=c.reduce(((t,e)=>Math.max(t,e.length)),0),c=c.map((t=>(t.length=this._row_headers_length,t)))),e.config.row_pivots=void 0!==u?Array(u).fill(0):Array(c?.[0]?.length||0).fill(0),e.config.column_pivots=void 0!==f?Array(f).fill(0):Array(d?.[0]?.length||0).fill(0);let M,k={viewport_width:0,selected_id:i,ridx_offset:y,sub_cell_offset:this._column_sizes.indices[(this._row_headers_length||0)+Math.floor(l.start_col)]||0,x0:b,x1:x,y1:z,row_height:this._column_sizes.row_height,row_headers_length:this._row_headers_length},L=0,T=[],W=!0;if(c?.length>0){let t=h.row_pivots.join(","),i={column_name:t,cidx:0,column_data:c,row_headers:c,first_col:W},l=L+Math.floor(b);M=this.body.draw(o,i,{...k,x0:0},!0,void 0,void 0,l,v);let a=[];for(let i=0;i<e.config.row_pivots.length;i++){let s=this.header.draw(t,Array(e.config.column_pivots.length).fill(""),1,void 0,i,b,i,w,g);s&&a.push(s)}if(W=!1,k.viewport_width+=a.reduce(((t,{th:e},i)=>t+(this._column_sizes.indices[i]||e.offsetWidth)),0),k.row_height=k.row_height||M.row_height,L=c[0].length,!s)for(let t=0;t<e.config.row_pivots.length;t++){let{td:e,metadata:i}=M.tds[t]||{},{th:s,metadata:l}=a[t]||{};(e||s)&&T.push([s||e,l||i])}}try{let t=0,e=a-l.start_col;for(;t<e;){if(!n[t]){let e=Math.max(l.end_col,0);l.start_col=e;let i=0,s=0;for(;this._column_sizes.indices.length>L+b+i+1&&s+k.viewport_width<_;)i++,s+=this._column_sizes.indices[L+b+i];if(s+k.viewport_width<_){let t=Math.min(a,e+5);l.end_col=Math.max(1,Math.min(a,t))}else l.end_col=Math.max(1,Math.min(a,e+i));let o=r(Math.floor(l.start_col),Math.floor(l.start_row),Math.ceil(l.end_col),Math.ceil(l.end_row));yield;let h=await o;if(typeof h.column_header_merge_depth<"u"&&(w=h.column_header_merge_depth),typeof h.merge_headers<"u"&&(p=h.merge_headers),0===h.data.length)return void(yield T);l.end_col=l.start_col+h.data.length;for(let e=0;e<h.data.length;e++)n[t+e]=h.data[e],h.metadata&&(m[t+e]=h.metadata[e]),d&&(d[t+e]=h.column_headers?.[e])}let e=d?.[t]||"",i=n[t],h=m?.[t],u={column_name:e,cidx:L,column_data:i,column_data_listener_metadata:h,row_headers:c,first_col:W},f=t+b,y=L+Math.floor(b),x=this.header.draw(void 0,e,void 0,f,y,b,L,w,g);if(M=this.body.draw(o,u,k,!1,f,b,y,v),W=!1,!s)for(let{td:t,metadata:e}of M.tds)T.push([x?.th||t,x?.metadata||e]);let z=this._column_sizes.indices[L+Math.floor(b)];if(k.viewport_width+=z||(x?.th?.offsetWidth||M.tds.reduce(((t,e)=>t+e.td?.offsetWidth),0)),k.row_height=k.row_height||M.row_height,L++,t++,k.viewport_width-k.sub_cell_offset>_){this.body.clean({ridx:M?.ridx||0,cidx:L}),this.header.clean(),yield T,k.viewport_width=0;for(let[t]of T)k.viewport_width+=t.offsetWidth;if(k.viewport_width-k.sub_cell_offset>_)return}}this.body.clean({ridx:M?.ridx||0,cidx:L}),this.header.clean(),yield T}finally{this.body.clean({ridx:M?.ridx||0,cidx:L}),this.header.clean(),this.body._span_factory.reset(),this.header._span_factory.reset()}}},bt=["both","horizontal","vertical","none"],lt=class extends J{constructor(){super(),this._column_sizes={auto:[],override:[],indices:[]},this._style_callbacks=[],this._initialized=!1}connectedCallback(){this._initialized||(this.create_shadow_dom(),this.register_listeners(),this.setAttribute("tabindex","0"),this._initialized=!0,this.table_model=new V(this._table_clip,this._column_sizes,this))}_reset_viewport(){this._start_row=void 0,this._end_row=void 0,this._start_col=void 0,this._end_col=void 0}_reset_scroll(){this._column_sizes.indices=[],this.scrollTop=0,this.scrollLeft=0,this._reset_viewport()}_resetAutoSize(){this._column_sizes.auto=[],this._column_sizes.override=[],this._column_sizes.indices=[];for(let t=0;t<this.table_model.header.num_columns();t++){let e=this.table_model.header.get_column_header(t);e.style.minWidth="",e.style.maxWidth=""}}clear(){this.table_model=new V(this._table_clip,this._column_sizes,this)}addStyleListener(t){this._style_callbacks=this._style_callbacks.concat(t);let e=!0;return()=>{if(!e)return;e=!1;let i=this._style_callbacks=this._style_callbacks.slice(),s=i.indexOf(t);i.splice(s,1)}}removeStyleListener(t){let e=this._style_callbacks.length;this._style_callbacks=this._style_callbacks.filter((e=>e!==t)),console.assert(this._style_callbacks.length===e-1,"No listener found")}invalidate(){if(!this._is_styling)throw new Error("Cannot call `invalidate()` outside of a `StyleListener`");this._invalidated=!0}getMeta(t){if(!(typeof t>"u")){if(t instanceof HTMLElement)return T.get(t);if(t.row_header_x>=0){if(t.row_header_x<this._view_cache.config.row_pivots.length){let e=this.table_model.body._fetch_cell(t.y,t.row_header_x);return this.getMeta(e)}}else{if(!(t.column_header_y>=0))return this.getMeta(this.table_model.body._fetch_cell(t.dy,t.dx+this.table_model._row_headers_length));if(t.column_header_y<this._view_cache.config.column_pivots.length){let e=this.table_model.body._fetch_cell(t.column_header_y,t.y);return this.getMeta(e)}}}}getDrawFPS(){return rt()}async scrollToCell(t,e){if(!this._view_cache)return void console.warn("data listener not configured");let i=this._column_sizes.row_height||19,s=this._view_cache.config.column_pivots.length*i,l=(this._table_clip.offsetHeight-s)%i,a=(this._virtual_panel.offsetHeight-l)/this._nrows;this.scrollTop=Math.ceil(a*e);let _=0;for(;t>0;)t--,_+=this._column_sizes.indices[t+this._view_cache.config.row_pivots.length]||60;this.scrollLeft=Math.ceil(_),await new Promise(requestAnimationFrame),await this._draw_flush()}setDataListener(t,{virtual_mode:e="both",preserve_state:i=!1}={}){console.assert(bt.indexOf(e)>-1,`Unknown virtual_mode ${e};  valid options are "both" (default), "horizontal", "vertical" or "none"`);let s=this._virtual_mode!==e;if(i)console.assert(!s,"preserve_state called with modified virtual_mode"),this._view_cache.view=t;else{let i={row_pivots:[],column_pivots:[]};this._virtual_mode=e,this._invalid_schema=!0,this._view_cache={view:t,config:i},s&&this._setup_virtual_scroll()}}__noop_jsdoc_hints(){}};document.createElement("regular-table").constructor===HTMLElement&&window.customElements.define("regular-table",lt);
//# sourceMappingURL=/sm/d66d2fba4540d571b918eb2d8ee14785a43b90b8a47bf4c8147c12ebc7c15bf2.map